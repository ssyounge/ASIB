# sweeps/asmb_grid.yaml

# â€”â€”â€”â€” Sweep ì „ëµ â€”â€”â€”â€”
method: bayes           # bayesian + grid í˜¼í•©
metric:
  name: stage4_student_acc
  goal: maximize

# v0.16+ ê·œê²©
controller:
  type: local        # ë˜ëŠ” 'thread'
  max_parallel: 4    # (= ì˜ˆì „ concurrency)

parameters:             # ---- Hyper-search ê³µê°„ ----
  # ğŸ”§ 1) learning-rate (log10 ê· ë“±)
  student_lr:
    distribution: log_uniform_values   # 6e-4  ~  1.4e-3
    min: 0.0005
    max: 0.0018

  # ğŸ‘€ sweep ì˜ì—­ í™•ì¥
  ib_beta:                             # Î² (IB loss) â†’ ì¢€ ë” ë„“ê²Œ
    distribution: uniform
    min: 0.0015
    max: 0.006

  # â€“â€“â€“â€“ GRID / ê³ ì • â€“â€“â€“â€“
  use_partial_freeze:
    values: [true]
  student_freeze_level:
    values: [1]        # stem+layer1 freeze
  hybrid_beta:
    values: [0.20, 0.25, 0.30]         # 3-way grid
  kd_alpha:                            # KD-vs-CE ê°€ì¤‘ì¹˜
    values: [0.70, 0.75, 0.80]
  ce_alpha:
    values: [0.20, 0.25, 0.30]         # í•„ìš”í•˜ë©´ 1-kd ë¡œ ê³„ì‚°í•˜ë„ë¡ main ì—ì„œ ì²˜ë¦¬
  tau_start:
    values: [7, 8, 9]
  tau_end:
    values: [2, 3]
  tau_decay_epochs:
    values: [5, 6, 7]
  student_epochs_per_stage:
    values: [12, 15, 18]    # í•­ìƒ ê³ ì •

# ì‹¤í–‰ ì»¤ë§¨ë“œ (W&B ìƒˆ ê·œê²©: list í˜•)
command:
  - ${env}
  - python
  - main.py
  - "--config=configs/default.yaml"
  - "--hparams=configs/hparams.yaml"
  - ${args}
