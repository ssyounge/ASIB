# configs/base.yaml
defaults:
  - dataset@experiment.dataset: cifar100
  - schedule@experiment.schedule: cosine
  - method@experiment.method: asib
  - _self_

experiment:
  device: cuda
  seed: 42
  small_input: true

  results_dir: experiments/default/results
  exp_id: default

  dataset:
    batch_size: 64
    num_workers: 2

  num_stages: 1
  student_epochs_per_stage: [5]
  teacher_adapt_epochs: 0
  use_partial_freeze: false

  use_amp: true
  amp_dtype: float16

  use_ib: false
  ib_epochs_per_stage: 0
  ib_beta: 0.0
  ib_beta_warmup_epochs: 0
  use_vib_synergy_head: false
  ib_mbm_query_dim: 2048
  ib_mbm_out_dim: 512
  ib_mbm_n_head: 1
  ib_mbm_feature_norm: l2
  ib_mbm_reg_lambda: 0.0

  a_step_lr: 1.0e-4
  a_step_weight_decay: 1.0e-4
  b_step_lr: 1.0e-1
  b_step_weight_decay: 3.0e-4
  b_step_momentum: 0.9
  b_step_nesterov: true
  grad_clip_norm: 1.0

  ce_alpha: 0.3
  kd_ens_alpha: 0.0
  hybrid_beta: 0.05

  use_cccp: false
  tau: 4.0
  cccp_nt: 1
  cccp_ns: 1
