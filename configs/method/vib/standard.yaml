# configs/method/vib/standard.yaml

method: vib
teacher_iters: 20
mbm_type: GATE
z_dim: 512
beta_bottleneck: 5e-4       # KL loss 가 1.0 이상으로 올라오도록 살짝 강화
proj_hidden_dim: 1024
proj_use_bn: true
log_kl: false
student_iters: 240          # 학습 길이 확보
student_lr: 2e-3            # warmup 길어질 때 LR 살짝 ↑
min_lr_ratio_student: 0.01  # cosine tail 을 1e-5 레벨까지
lr_warmup_epochs: 5         # 긴 일정에 맞춰 늘림

# ─ Teacher(VIB‑MBM) 학습 ─
teacher_lr          : 1e-3
teacher_weight_decay: 5e-4
gate_dropout        : 0.1
teacher_dropout_p   : 0.3

# ─ KD 스케줄 (α, T) ─
kd_alpha_init : 0.2          # 초반 CE 80 : KD 20
kd_alpha_final: 0.7         # 마지막에 KD 비율 ↑
kd_T_init     : 5            # 너무 높은 T 는 early stage 발산 위험
kd_T_final    : 2
kd_warmup_frac: 0.01
kd_schedule_granularity: epoch
kd_sched_pow  : 0.5
ce_alpha      : 1.0

# ─ Latent 정렬 ─
latent_alpha        : 0.5
latent_warmup_frac  : 0.3
latent_mse_weight   : 0.7
latent_angle_weight : 0.3
cw_mse_eps: 1e-6                 # 확신도‑가중 MSE용 ε (분모 보호)
latent_norm: "dim"          # "dim" | "sqrt" | "none"
latent_clamp_min: -6
latent_clamp_max: 2

# ─ Feature distillation ─
feat_layers   : [2, 3]
feat_weights  : [0.5, 0.5]
feat_loss_weight: [0.2, 0.15, 0.1]

# ───── 추가 override (base.yaml 값을 덮어쓰기) ─────
cutmix_alpha_distill: 1.0        # 강한 CutMix 유지
ema_decay           : 0.995      # 긴 학습에서 더 안정적인 EMA
