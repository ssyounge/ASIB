# configs/experiment/res152_effi_l2.yaml
defaults:
  - /base
  - /model/teacher@teacher1: resnet152          # ← 처음 선언 → “override” 제거
  - /model/teacher@teacher2: efficientnet_l2    # ← idem
  - /model/student:          resnet152_pretrain # ← override 불필요
  - _self_

# ===== 필수 하이퍼파라미터 =====
student_type: resnet152
teacher_lr:   1e-4
teacher_weight_decay: 1e-4
student_lr:   8e-4
student_weight_decay: 8e-4

# 사용될 teacher 아키텍처 이름 지정
teacher1_type: resnet152
teacher2_type: efficientnet_l2

# ===== 경로 =====
teacher1_ckpt: checkpoints/resnet152_cifar32.pth
teacher2_ckpt: checkpoints/efficientnet_l2_cifar32.pth
results_dir:  outputs/res152_effi_l2
exp_id:       res152_effi_l2

# ===== Freeze / Stage 스케줄 =====
use_partial_freeze: true
num_stages: 4
teacher_adapt_epochs: 3
student_freeze_schedule:  [-1, 2, 1, 0]
student_epochs_schedule:  [30, 6, 4, 4]
teacher1_freeze_level: 1
teacher2_freeze_level: 1
student_freeze_bn:     false
teacher1_freeze_bn:    true
teacher2_freeze_bn:    true

# ===== ASMB 추가 옵션 =====
batch_size: 128
use_distillation_adapter: true
distill_out_dim: 512
mbm_query_dim: 2048        # resnet152 feat_2d 크기

# ───── KD 세부 옵션 ───────────────────────────────
# Ensemble Distill + Disagreement Weighting
kd_alpha:       0.0        # 개별 KL OFF
kd_ens_alpha:   0.7        # Ensemble‑KL ON
disagree_mode:  both_wrong # pred | both_wrong | any_wrong
lambda_high:    1.5        # 동시 오류 샘플 가중치 ↑
lambda_low:     1.0
