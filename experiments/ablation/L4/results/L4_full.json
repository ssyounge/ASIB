{
    "dataset": {
        "name": "cifar100",
        "root": "./data",
        "small_input": true,
        "data_aug": 1,
        "batch_size": 64,
        "num_workers": 8,
        "pin_memory": true,
        "persistent_workers": true,
        "prefetch_factor": 2
    },
    "schedule": {
        "type": "cosine",
        "lr_warmup_epochs": 5,
        "min_lr": 1e-05
    },
    "method": {
        "name": "asib",
        "ce_alpha": 0.3,
        "kd_alpha": 0.7,
        "kd_ens_alpha": 0.0,
        "use_ib": true,
        "ib_beta": 0.01,
        "feat_kd_alpha": 0.1,
        "kd_target": "synergy",
        "teacher_weights": [
            0.4,
            0.6
        ],
        "use_distillation_adapter": true,
        "min_cw": 0.1
    },
    "device": "cuda",
    "seed": 42,
    "small_input": true,
    "results_dir": "experiments/ablation/L4/results",
    "exp_id": "L4_full",
    "num_stages": 4,
    "student_epochs_per_stage": [
        10,
        10,
        10,
        10
    ],
    "teacher_adapt_epochs": 6,
    "use_partial_freeze": 1,
    "use_amp": true,
    "amp_dtype": "bfloat16",
    "use_ib": 1,
    "ib_epochs_per_stage": 6,
    "ib_beta": 0.0001,
    "ib_beta_warmup_epochs": 4,
    "use_vib_synergy_head": false,
    "ib_mbm_query_dim": 512,
    "ib_mbm_out_dim": 512,
    "ib_mbm_n_head": 4,
    "ib_mbm_feature_norm": "l2",
    "ib_mbm_reg_lambda": 0.0,
    "a_step_lr": 0.0001,
    "a_step_weight_decay": 0.0001,
    "b_step_lr": 0.1,
    "b_step_weight_decay": 0.0003,
    "b_step_momentum": 0.9,
    "b_step_nesterov": true,
    "grad_clip_norm": 0.5,
    "ce_alpha": 0.65,
    "kd_ens_alpha": 0.0,
    "hybrid_beta": 0.05,
    "use_cccp": 1,
    "tau": 4.0,
    "cccp_nt": 1,
    "cccp_ns": 1,
    "compute_teacher_eval": true,
    "use_teacher_finetuning": 0,
    "train_distill_adapter_only": true,
    "disagreement_max_samples": 2000,
    "disagreement_max_batches": 10,
    "teacher_lr": 3e-06,
    "teacher_weight_decay": 0.0001,
    "student_lr": 0.001,
    "student_weight_decay": 0.0003,
    "teacher_adapt_kd_warmup": 0,
    "use_loss_clamp": true,
    "loss_clamp_max": 100.0,
    "teacher1": {
        "name": "convnext_l",
        "pretrained": true
    },
    "teacher2": {
        "name": "resnet152",
        "pretrained": true
    },
    "model": {
        "student": {
            "name": "resnet101_scratch",
            "pretrained": false,
            "use_adapter": true
        }
    },
    "teacher1_ckpt": "checkpoints/teachers/convnext_l_cifar100.pth",
    "teacher2_ckpt": "checkpoints/teachers/resnet152_cifar100.pth",
    "kd_target": "avg",
    "kd_alpha": 0.35,
    "tau_schedule": [
        4.0,
        8.0
    ],
    "kd_warmup_epochs": 0,
    "kd_max_ratio": 2.0,
    "ce_label_smoothing": 0.0,
    "feat_kd_alpha": 0.0,
    "ib_mbm_logvar_clip": 6,
    "ib_mbm_min_std": 0.001,
    "ib_mbm_lr_factor": 10,
    "use_cccp_in_a": true,
    "cccp_alpha": 0.25,
    "student_freeze_level": 1,
    "teacher1_freeze_level": 1,
    "teacher2_freeze_level": 1,
    "student_freeze_bn": true,
    "teacher1_freeze_bn": true,
    "teacher2_freeze_bn": true,
    "synergy_only_epochs": 5,
    "synergy_ce_alpha": 1.0,
    "enable_kd_after_syn_acc": 0.6,
    "use_distillation_adapter": true,
    "distill_out_dim": 512,
    "feat_kd_key": "distill_feat",
    "optimizer": "adamw",
    "teacher_weights": [
        0.4,
        0.6
    ],
    "min_cw": 0.1,
    "student_epochs_schedule": [
        10,
        10,
        10,
        10
    ],
    "student_iters": 10,
    "num_classes": 100,
    "student_freeze_schedule": [
        1,
        0,
        -1,
        -1
    ],
    "student_pretrained": true,
    "effective_teacher_lr": 3e-06,
    "effective_teacher_wd": 0.0001,
    "cur_stage": 4,
    "ep1_cw_mean": 0.10205078125,
    "ep1_cw_min": 0.10009765625,
    "ep1_cw_max": 0.119140625,
    "ep1_logvar_mean": 2.351909637451172,
    "ep2_cw_mean": 0.4609375,
    "ep2_cw_min": 0.326171875,
    "ep2_cw_max": 0.62890625,
    "ep2_logvar_mean": 0.8175646662712097,
    "ep3_cw_mean": 0.59765625,
    "ep3_cw_min": 0.46875,
    "ep3_cw_max": 0.84765625,
    "ep3_logvar_mean": 0.5578019022941589,
    "ep4_cw_mean": 0.7265625,
    "ep4_cw_min": 0.4921875,
    "ep4_cw_max": 1.0,
    "ep4_logvar_mean": 0.3745712339878082,
    "ep5_cw_mean": 0.7890625,
    "ep5_cw_min": 0.5859375,
    "ep5_cw_max": 1.0,
    "ep5_logvar_mean": 0.2905806303024292,
    "ep6_cw_mean": 0.87109375,
    "ep6_cw_min": 0.66796875,
    "ep6_cw_max": 1.0,
    "ep6_logvar_mean": 0.18713408708572388,
    "last_synergy_acc": 0.8665999999999999,
    "teacher_ep6_loss": 0.41752756225585935,
    "teacher_ep6_synAcc": 86.66,
    "epoch6_tau": 6.222222222222222,
    "stage1_student_trainable_params": 326,
    "stage1_teacher1_trainable_params": 4,
    "stage1_teacher2_trainable_params": 4,
    "stage1_ib_mbm_trainable": 12,
    "stage1_synergy_head_trainable": 4,
    "stage1_teacher_disagree": 8.59375,
    "student_ep1_acc": 65.02,
    "student_ep1_loss": 0.08570828062057495,
    "ep1_mix_mode": "none",
    "epoch1_tau": 4.0,
    "student_ep2_acc": 64.2,
    "student_ep2_loss": 0.0828621605014801,
    "ep2_mix_mode": "none",
    "epoch2_tau": 4.444444444444445,
    "student_ep3_acc": 65.54,
    "student_ep3_loss": 0.08029923284769058,
    "ep3_mix_mode": "none",
    "epoch3_tau": 4.888888888888889,
    "student_ep4_acc": 65.55,
    "student_ep4_loss": 0.07807476120233536,
    "ep4_mix_mode": "none",
    "epoch4_tau": 5.333333333333333,
    "student_ep5_acc": 66.18,
    "student_ep5_loss": 0.0757709935760498,
    "ep5_mix_mode": "none",
    "epoch5_tau": 5.777777777777778,
    "student_ep6_acc": 66.03,
    "student_ep6_loss": 0.07450716591358185,
    "ep6_mix_mode": "none",
    "student_ep7_acc": 65.7,
    "student_ep7_loss": 0.07331411232471466,
    "ep7_mix_mode": "none",
    "epoch7_tau": 6.666666666666666,
    "student_ep8_acc": 66.07,
    "student_ep8_loss": 0.07257749721765518,
    "ep8_mix_mode": "none",
    "epoch8_tau": 7.111111111111111,
    "student_ep9_acc": 65.77,
    "student_ep9_loss": 0.07222668226242066,
    "ep9_mix_mode": "none",
    "epoch9_tau": 7.555555555555555,
    "student_ep10_acc": 66.24,
    "student_ep10_loss": 0.07135963894844055,
    "ep10_mix_mode": "none",
    "epoch10_tau": 8.0,
    "stage1_acc": 49.07,
    "stage1_wall_min": 13.25491460164388,
    "stage1_gpu_h": 0.22091524336073134,
    "stage1_gflops": 0.0,
    "stage1_param_M": 49.470604,
    "stage1_student_acc": 49.07,
    "stage1_teacher_acc": 86.23,
    "epoch22_tau": 6.222222222222222,
    "stage2_student_trainable_params": 326,
    "stage2_teacher1_trainable_params": 4,
    "stage2_teacher2_trainable_params": 4,
    "stage2_ib_mbm_trainable": 12,
    "stage2_synergy_head_trainable": 4,
    "stage2_teacher_disagree": 8.59375,
    "epoch17_tau": 4.0,
    "epoch18_tau": 4.444444444444445,
    "epoch19_tau": 4.888888888888889,
    "epoch20_tau": 5.333333333333333,
    "epoch21_tau": 5.777777777777778,
    "epoch23_tau": 6.666666666666666,
    "epoch24_tau": 7.111111111111111,
    "epoch25_tau": 7.555555555555555,
    "epoch26_tau": 8.0,
    "stage2_acc": 58.92,
    "stage2_wall_min": 13.273815019925435,
    "stage2_gpu_h": 0.22123025033209057,
    "stage2_gflops": 0.0,
    "stage2_param_M": 49.470604,
    "stage2_student_acc": 58.92,
    "stage2_teacher_acc": 84.02,
    "epoch38_tau": 6.222222222222222,
    "stage3_student_trainable_params": 326,
    "stage3_teacher1_trainable_params": 4,
    "stage3_teacher2_trainable_params": 4,
    "stage3_ib_mbm_trainable": 12,
    "stage3_synergy_head_trainable": 4,
    "stage3_teacher_disagree": 8.59375,
    "epoch33_tau": 4.0,
    "epoch34_tau": 4.444444444444445,
    "epoch35_tau": 4.888888888888889,
    "epoch36_tau": 5.333333333333333,
    "epoch37_tau": 5.777777777777778,
    "epoch39_tau": 6.666666666666666,
    "epoch40_tau": 7.111111111111111,
    "epoch41_tau": 7.555555555555555,
    "epoch42_tau": 8.0,
    "stage3_acc": 64.89,
    "stage3_wall_min": 13.226578056812286,
    "stage3_gpu_h": 0.2204429676135381,
    "stage3_gflops": 0.0,
    "stage3_param_M": 49.470604,
    "stage3_student_acc": 64.89,
    "stage3_teacher_acc": 86.57,
    "epoch54_tau": 6.222222222222222,
    "stage4_student_trainable_params": 326,
    "stage4_teacher1_trainable_params": 4,
    "stage4_teacher2_trainable_params": 4,
    "stage4_ib_mbm_trainable": 12,
    "stage4_synergy_head_trainable": 4,
    "stage4_teacher_disagree": 8.59375,
    "epoch49_tau": 4.0,
    "epoch50_tau": 4.444444444444445,
    "epoch51_tau": 4.888888888888889,
    "epoch52_tau": 5.333333333333333,
    "epoch53_tau": 5.777777777777778,
    "epoch55_tau": 6.666666666666666,
    "epoch56_tau": 7.111111111111111,
    "epoch57_tau": 7.555555555555555,
    "epoch58_tau": 8.0,
    "stage4_acc": 66.24,
    "stage4_wall_min": 13.075641508897146,
    "stage4_gpu_h": 0.2179273584816191,
    "stage4_gflops": 0.0,
    "stage4_param_M": 49.470604,
    "stage4_student_acc": 66.24,
    "stage4_teacher_acc": 86.66,
    "final_student_acc": 66.24,
    "total_time_sec": 5081.795241832733,
    "csv_filename": "summary.csv"
}