{
    "dataset": {
        "name": "cifar100",
        "root": "./data",
        "small_input": true,
        "data_aug": 1,
        "batch_size": 64,
        "num_workers": 8,
        "pin_memory": true,
        "persistent_workers": true,
        "prefetch_factor": 2
    },
    "schedule": {
        "type": "cosine",
        "lr_warmup_epochs": 5,
        "min_lr": 1e-06
    },
    "device": "cuda",
    "seed": 42,
    "small_input": true,
    "results_dir": "experiments/ablation/L4/results",
    "exp_id": "L4_full",
    "num_stages": 4,
    "student_epochs_per_stage": [
        20,
        20,
        20,
        20
    ],
    "teacher_adapt_epochs": 6,
    "use_partial_freeze": 1,
    "use_amp": true,
    "amp_dtype": "bfloat16",
    "use_ib": 1,
    "ib_epochs_per_stage": 6,
    "ib_beta": 5e-05,
    "ib_beta_warmup_epochs": 4,
    "use_vib_synergy_head": false,
    "ib_mbm_query_dim": 512,
    "ib_mbm_out_dim": 512,
    "ib_mbm_n_head": 4,
    "ib_mbm_feature_norm": "l2",
    "ib_mbm_reg_lambda": 0.0,
    "a_step_lr": 0.0001,
    "a_step_weight_decay": 0.0001,
    "b_step_lr": 0.1,
    "b_step_weight_decay": 0.0003,
    "b_step_momentum": 0.9,
    "b_step_nesterov": true,
    "grad_clip_norm": 0.5,
    "ce_alpha": 0.65,
    "kd_ens_alpha": 0.5,
    "hybrid_beta": 0.05,
    "use_cccp": 1,
    "tau": 4.0,
    "cccp_nt": 1,
    "cccp_ns": 1,
    "compute_teacher_eval": true,
    "use_teacher_finetuning": 0,
    "train_distill_adapter_only": true,
    "disagreement_max_samples": 2000,
    "disagreement_max_batches": 10,
    "teacher_lr": 3e-06,
    "teacher_weight_decay": 0.0001,
    "student_lr": 0.001,
    "student_weight_decay": 0.0003,
    "teacher_adapt_kd_warmup": 6,
    "use_loss_clamp": true,
    "loss_clamp_max": 20.0,
    "teacher1": {
        "name": "convnext_l",
        "pretrained": true
    },
    "teacher2": {
        "name": "resnet152",
        "pretrained": true
    },
    "model": {
        "student": {
            "name": "resnet101_scratch",
            "pretrained": false,
            "use_adapter": true
        }
    },
    "teacher1_ckpt": "checkpoints/teachers/convnext_l_cifar100.pth",
    "teacher2_ckpt": "checkpoints/teachers/resnet152_cifar100.pth",
    "kd_target": "synergy",
    "enable_kd_after_syn_acc": 0.8,
    "kd_alpha": 0.35,
    "tau_schedule": [
        3.5,
        5.0
    ],
    "kd_warmup_epochs": 3,
    "kd_max_ratio": 1.25,
    "ce_label_smoothing": 0.0,
    "feat_kd_alpha": 0.25,
    "min_cw": 0.5,
    "max_cw": 1.5,
    "ib_mbm_logvar_clip": 4,
    "ib_mbm_min_std": 0.01,
    "ib_mbm_lr_factor": 2,
    "use_cccp_in_a": true,
    "cccp_alpha": 0.2,
    "student_freeze_level_schedule": [
        -1,
        -1,
        1,
        1
    ],
    "teacher1_freeze_level_schedule": [
        -1,
        -1,
        1,
        1
    ],
    "teacher2_freeze_level_schedule": [
        -1,
        -1,
        1,
        1
    ],
    "student_freeze_bn": true,
    "teacher1_freeze_bn": true,
    "teacher2_freeze_bn": true,
    "synergy_only_epochs": 2,
    "synergy_ce_alpha": 1.0,
    "disable_loss_clamp_in_a": true,
    "use_distillation_adapter": true,
    "distill_out_dim": 512,
    "feat_kd_key": "distill_feat",
    "optimizer": "adamw",
    "loss_clamp_mode": "soft",
    "loss_clamp_warmup_epochs": 8,
    "mixup_alpha": 0.2,
    "cutmix_alpha_distill": 1.0,
    "teacher_weights": [
        0.4,
        0.6
    ],
    "student_epochs_schedule": [
        20,
        20,
        20,
        20
    ],
    "student_iters": 20,
    "num_classes": 100,
    "student_freeze_schedule": [
        -1,
        -1,
        -1,
        -1
    ],
    "student_pretrained": false,
    "student_freeze_level": -1,
    "teacher1_freeze_level": -1,
    "teacher2_freeze_level": -1,
    "effective_teacher_lr": 3e-06,
    "effective_teacher_wd": 0.0001,
    "cur_stage": 4,
    "teacher_ep1_ib_beta": 5e-05,
    "teacher_ep1_ib_kld": 0.15641148388385773,
    "ep1_cw_mean": 1.0,
    "ep1_cw_min": 1.0,
    "ep1_cw_max": 1.0,
    "ep1_logvar_mean": -3.4488241453800583e-06,
    "teacher_ep2_ib_beta": 5e-05,
    "teacher_ep2_ib_kld": 0.9338752627372742,
    "ep2_cw_mean": 1.0,
    "ep2_cw_min": 1.0,
    "ep2_cw_max": 1.0,
    "ep2_logvar_mean": 1.698739106359426e-05,
    "teacher_ep3_ib_beta": 5e-05,
    "teacher_ep3_ib_kld": 1.0722248554229736,
    "ep3_cw_mean": 1.0,
    "ep3_cw_min": 1.0,
    "ep3_cw_max": 1.0,
    "ep3_logvar_mean": 6.163186299090739e-07,
    "teacher_ep4_ib_beta": 5e-05,
    "teacher_ep4_ib_kld": 1.4807089567184448,
    "ep4_cw_mean": 1.0,
    "ep4_cw_min": 1.0,
    "ep4_cw_max": 1.0,
    "ep4_logvar_mean": -4.278908818378113e-05,
    "teacher_ep5_ib_beta": 5e-05,
    "teacher_ep5_ib_kld": 0.33100876212120056,
    "ep5_cw_mean": 1.0,
    "ep5_cw_min": 1.0,
    "ep5_cw_max": 1.0,
    "ep5_logvar_mean": -0.00016046508972067386,
    "teacher_ep6_ib_beta": 5e-05,
    "teacher_ep6_ib_kld": 0.95481276512146,
    "ep6_cw_mean": 1.0,
    "ep6_cw_min": 1.0,
    "ep6_cw_max": 1.0,
    "ep6_logvar_mean": -0.0005033930647186935,
    "last_synergy_acc": 0.0111,
    "last_synergy_acc_pct": 1.11,
    "teacher_ep6_loss": 6.232338462524414,
    "teacher_ep6_synAcc": 1.11,
    "epoch6_tau": 3.8947368421052633,
    "stage1_student_trainable_params": 326,
    "stage1_teacher1_trainable_params": 4,
    "stage1_teacher2_trainable_params": 4,
    "stage1_ib_mbm_trainable": 12,
    "stage1_synergy_head_trainable": 4,
    "stage1_teacher_disagree": 8.59375,
    "student_ep1_gate_ratio": 0.0,
    "student_ep1_kd_syn_ratio": 0.0,
    "student_ep1_kd_clamp_ratio": 0.20076726342711,
    "student_ep1_kd_scale_mean": 0.6909098186690337,
    "student_ep1_acc": 71.69,
    "student_ep1_loss": 1.105483930568695,
    "ep1_mix_mode": "cutmix",
    "epoch1_tau": 3.5,
    "student_ep2_gate_ratio": 0.0,
    "student_ep2_kd_syn_ratio": 0.0,
    "student_ep2_kd_clamp_ratio": 0.2391304347826087,
    "student_ep2_kd_scale_mean": 0.6624614185190456,
    "student_ep2_acc": 71.41,
    "student_ep2_loss": 1.0796582889938355,
    "ep2_mix_mode": "cutmix",
    "epoch2_tau": 3.5789473684210527,
    "student_ep3_gate_ratio": 0.0,
    "student_ep3_kd_syn_ratio": 0.0,
    "student_ep3_kd_clamp_ratio": 0.22122762148337596,
    "student_ep3_kd_scale_mean": 0.6819301667930073,
    "student_ep3_acc": 71.15,
    "student_ep3_loss": 1.0798289200401305,
    "ep3_mix_mode": "cutmix",
    "epoch3_tau": 3.6578947368421053,
    "student_ep4_gate_ratio": 0.0,
    "student_ep4_kd_syn_ratio": 0.0,
    "student_ep4_kd_clamp_ratio": 0.17391304347826086,
    "student_ep4_kd_scale_mean": 0.6809219516375485,
    "student_ep4_acc": 71.45,
    "student_ep4_loss": 1.1375894815826415,
    "ep4_mix_mode": "cutmix",
    "epoch4_tau": 3.736842105263158,
    "student_ep5_gate_ratio": 0.0,
    "student_ep5_kd_syn_ratio": 0.0,
    "student_ep5_kd_clamp_ratio": 0.18030690537084398,
    "student_ep5_kd_scale_mean": 0.7248018821503254,
    "student_ep5_acc": 70.4,
    "student_ep5_loss": 1.113519288368225,
    "ep5_mix_mode": "cutmix",
    "epoch5_tau": 3.8157894736842106,
    "student_ep6_gate_ratio": 0.0,
    "student_ep6_kd_syn_ratio": 0.0,
    "student_ep6_kd_clamp_ratio": 0.18797953964194372,
    "student_ep6_kd_scale_mean": 0.7078276711459063,
    "student_ep6_acc": 72.06,
    "student_ep6_loss": 1.088839432849884,
    "ep6_mix_mode": "cutmix",
    "student_ep7_gate_ratio": 0.0,
    "student_ep7_kd_syn_ratio": 0.0,
    "student_ep7_kd_clamp_ratio": 0.18542199488491048,
    "student_ep7_kd_scale_mean": 0.7474619637275565,
    "student_ep7_acc": 71.13,
    "student_ep7_loss": 1.0864012255477906,
    "ep7_mix_mode": "cutmix",
    "epoch7_tau": 3.973684210526316,
    "student_ep8_gate_ratio": 0.0,
    "student_ep8_kd_syn_ratio": 0.0,
    "student_ep8_kd_clamp_ratio": 0.13682864450127877,
    "student_ep8_kd_scale_mean": 0.7689592317443028,
    "student_ep8_acc": 72.0,
    "student_ep8_loss": 1.1327308564567566,
    "ep8_mix_mode": "cutmix",
    "epoch8_tau": 4.052631578947368,
    "student_ep9_gate_ratio": 0.0,
    "student_ep9_kd_syn_ratio": 0.0,
    "student_ep9_kd_clamp_ratio": 0.1432225063938619,
    "student_ep9_kd_scale_mean": 0.7396636706377778,
    "student_ep9_acc": 71.42,
    "student_ep9_loss": 1.148457767086029,
    "ep9_mix_mode": "cutmix",
    "epoch9_tau": 4.131578947368421,
    "student_ep10_gate_ratio": 0.0,
    "student_ep10_kd_syn_ratio": 0.0,
    "student_ep10_kd_clamp_ratio": 0.10741687979539642,
    "student_ep10_kd_scale_mean": 0.7856746958125205,
    "student_ep10_acc": 71.52,
    "student_ep10_loss": 1.1844612219810486,
    "ep10_mix_mode": "cutmix",
    "epoch10_tau": 4.2105263157894735,
    "student_ep11_gate_ratio": 0.0,
    "student_ep11_kd_syn_ratio": 0.0,
    "student_ep11_kd_clamp_ratio": 0.10485933503836317,
    "student_ep11_kd_scale_mean": 0.7720951230787649,
    "student_ep11_acc": 72.39,
    "student_ep11_loss": 1.1436263948059082,
    "ep11_mix_mode": "cutmix",
    "epoch11_tau": 4.2894736842105265,
    "student_ep12_gate_ratio": 0.0,
    "student_ep12_kd_syn_ratio": 0.0,
    "student_ep12_kd_clamp_ratio": 0.10358056265984655,
    "student_ep12_kd_scale_mean": 0.8050852712289787,
    "student_ep12_acc": 72.29,
    "student_ep12_loss": 1.151295625190735,
    "ep12_mix_mode": "cutmix",
    "epoch12_tau": 4.368421052631579,
    "student_ep13_gate_ratio": 0.0,
    "student_ep13_kd_syn_ratio": 0.0,
    "student_ep13_kd_clamp_ratio": 0.09462915601023018,
    "student_ep13_kd_scale_mean": 0.7968507546025354,
    "student_ep13_acc": 72.35,
    "student_ep13_loss": 1.1719375076103211,
    "ep13_mix_mode": "cutmix",
    "epoch13_tau": 4.447368421052632,
    "student_ep14_gate_ratio": 0.0,
    "student_ep14_kd_syn_ratio": 0.0,
    "student_ep14_kd_clamp_ratio": 0.09207161125319693,
    "student_ep14_kd_scale_mean": 0.816093864540259,
    "student_ep14_acc": 72.22,
    "student_ep14_loss": 1.160664059715271,
    "ep14_mix_mode": "cutmix",
    "epoch14_tau": 4.526315789473684,
    "student_ep15_gate_ratio": 0.0,
    "student_ep15_kd_syn_ratio": 0.0,
    "student_ep15_kd_clamp_ratio": 0.06777493606138107,
    "student_ep15_kd_scale_mean": 0.8351257196012533,
    "student_ep15_acc": 72.74,
    "student_ep15_loss": 1.170361895866394,
    "ep15_mix_mode": "cutmix",
    "epoch15_tau": 4.605263157894736,
    "student_ep16_gate_ratio": 0.0,
    "student_ep16_kd_syn_ratio": 0.0,
    "student_ep16_kd_clamp_ratio": 0.06649616368286446,
    "student_ep16_kd_scale_mean": 0.8402870343281672,
    "student_ep16_acc": 71.56,
    "student_ep16_loss": 1.1575016089820862,
    "ep16_mix_mode": "cutmix",
    "epoch16_tau": 4.684210526315789,
    "student_ep17_gate_ratio": 0.0,
    "student_ep17_kd_syn_ratio": 0.0,
    "student_ep17_kd_clamp_ratio": 0.056265984654731455,
    "student_ep17_kd_scale_mean": 0.8430206816304814,
    "student_ep17_acc": 72.23,
    "student_ep17_loss": 1.1691699808502198,
    "ep17_mix_mode": "cutmix",
    "epoch17_tau": 4.7631578947368425,
    "student_ep18_gate_ratio": 0.0,
    "student_ep18_kd_syn_ratio": 0.0,
    "student_ep18_kd_clamp_ratio": 0.04092071611253197,
    "student_ep18_kd_scale_mean": 0.8490117117762566,
    "student_ep18_acc": 71.28,
    "student_ep18_loss": 1.2009390710067749,
    "ep18_mix_mode": "cutmix",
    "epoch18_tau": 4.842105263157895,
    "student_ep19_gate_ratio": 0.0,
    "student_ep19_kd_syn_ratio": 0.0,
    "student_ep19_kd_clamp_ratio": 0.04475703324808184,
    "student_ep19_kd_scale_mean": 0.8283937232834953,
    "student_ep19_acc": 72.17,
    "student_ep19_loss": 1.1910203240203858,
    "ep19_mix_mode": "cutmix",
    "epoch19_tau": 4.921052631578947,
    "student_ep20_gate_ratio": 0.0,
    "student_ep20_kd_syn_ratio": 0.0,
    "student_ep20_kd_clamp_ratio": 0.029411764705882353,
    "student_ep20_kd_scale_mean": 0.8761124688646068,
    "student_ep20_acc": 72.55,
    "student_ep20_loss": 1.208250754852295,
    "ep20_mix_mode": "cutmix",
    "epoch20_tau": 5.0,
    "stage1_acc": 56.44,
    "stage1_wall_min": 26.7560404419899,
    "stage1_gpu_h": 0.4459340073664983,
    "stage1_gflops": 0.0,
    "stage1_param_M": 49.470604,
    "stage1_student_acc": 56.44,
    "stage1_teacher_acc": 0.95,
    "epoch32_tau": 3.8947368421052633,
    "stage2_student_trainable_params": 326,
    "stage2_teacher1_trainable_params": 4,
    "stage2_teacher2_trainable_params": 4,
    "stage2_ib_mbm_trainable": 12,
    "stage2_synergy_head_trainable": 4,
    "stage2_teacher_disagree": 8.59375,
    "epoch27_tau": 3.5,
    "epoch28_tau": 3.5789473684210527,
    "epoch29_tau": 3.6578947368421053,
    "epoch30_tau": 3.736842105263158,
    "epoch31_tau": 3.8157894736842106,
    "epoch33_tau": 3.973684210526316,
    "epoch34_tau": 4.052631578947368,
    "epoch35_tau": 4.131578947368421,
    "epoch36_tau": 4.2105263157894735,
    "epoch37_tau": 4.2894736842105265,
    "epoch38_tau": 4.368421052631579,
    "epoch39_tau": 4.447368421052632,
    "epoch40_tau": 4.526315789473684,
    "epoch41_tau": 4.605263157894736,
    "epoch42_tau": 4.684210526315789,
    "epoch43_tau": 4.7631578947368425,
    "epoch44_tau": 4.842105263157895,
    "epoch45_tau": 4.921052631578947,
    "epoch46_tau": 5.0,
    "stage2_acc": 67.62,
    "stage2_wall_min": 26.629293362299602,
    "stage2_gpu_h": 0.4438215560383267,
    "stage2_gflops": 0.0,
    "stage2_param_M": 49.470604,
    "stage2_student_acc": 67.62,
    "stage2_teacher_acc": 1.04,
    "epoch58_tau": 3.8947368421052633,
    "stage3_student_trainable_params": 326,
    "stage3_teacher1_trainable_params": 4,
    "stage3_teacher2_trainable_params": 4,
    "stage3_ib_mbm_trainable": 12,
    "stage3_synergy_head_trainable": 4,
    "stage3_teacher_disagree": 8.59375,
    "epoch53_tau": 3.5,
    "epoch54_tau": 3.5789473684210527,
    "epoch55_tau": 3.6578947368421053,
    "epoch56_tau": 3.736842105263158,
    "epoch57_tau": 3.8157894736842106,
    "epoch59_tau": 3.973684210526316,
    "epoch60_tau": 4.052631578947368,
    "epoch61_tau": 4.131578947368421,
    "epoch62_tau": 4.2105263157894735,
    "epoch63_tau": 4.2894736842105265,
    "epoch64_tau": 4.368421052631579,
    "epoch65_tau": 4.447368421052632,
    "epoch66_tau": 4.526315789473684,
    "epoch67_tau": 4.605263157894736,
    "epoch68_tau": 4.684210526315789,
    "epoch69_tau": 4.7631578947368425,
    "epoch70_tau": 4.842105263157895,
    "epoch71_tau": 4.921052631578947,
    "epoch72_tau": 5.0,
    "stage3_acc": 71.65,
    "stage3_wall_min": 26.640386033058167,
    "stage3_gpu_h": 0.4440064338843028,
    "stage3_gflops": 0.0,
    "stage3_param_M": 49.470604,
    "stage3_student_acc": 71.65,
    "stage3_teacher_acc": 1.01,
    "epoch84_tau": 3.8947368421052633,
    "stage4_student_trainable_params": 326,
    "stage4_teacher1_trainable_params": 4,
    "stage4_teacher2_trainable_params": 4,
    "stage4_ib_mbm_trainable": 12,
    "stage4_synergy_head_trainable": 4,
    "stage4_teacher_disagree": 8.59375,
    "epoch79_tau": 3.5,
    "epoch80_tau": 3.5789473684210527,
    "epoch81_tau": 3.6578947368421053,
    "epoch82_tau": 3.736842105263158,
    "epoch83_tau": 3.8157894736842106,
    "epoch85_tau": 3.973684210526316,
    "epoch86_tau": 4.052631578947368,
    "epoch87_tau": 4.131578947368421,
    "epoch88_tau": 4.2105263157894735,
    "epoch89_tau": 4.2894736842105265,
    "epoch90_tau": 4.368421052631579,
    "epoch91_tau": 4.447368421052632,
    "epoch92_tau": 4.526315789473684,
    "epoch93_tau": 4.605263157894736,
    "epoch94_tau": 4.684210526315789,
    "epoch95_tau": 4.7631578947368425,
    "epoch96_tau": 4.842105263157895,
    "epoch97_tau": 4.921052631578947,
    "epoch98_tau": 5.0,
    "stage4_acc": 72.74,
    "stage4_wall_min": 26.615925725301107,
    "stage4_gpu_h": 0.4435987620883518,
    "stage4_gflops": 0.0,
    "stage4_param_M": 49.470604,
    "stage4_student_acc": 72.74,
    "stage4_teacher_acc": 1.11,
    "final_student_acc": 72.74,
    "total_time_sec": 7834.645601272583,
    "csv_filename": "summary.csv"
}